---
title: "gullGPS"
author: "Dylan Titmuss"
date: "2024-03-08"
output: html_document
editor_options: 
  chunk_output_type: console
---

## Load packages
```{r}
library(tidyverse)
```

## Read data
```{r}
setwd("~/Desktop/Repos/GullsOfAppledore")

gull1 <- read.csv("data/GBBG_GPS/08-2018_05-2019/5-26-2019/ADI29_.csv", sep = ";", header = TRUE)

# try reading raw file

gull <- readLines(file("data/GBBG_GPS/08-2018_05-2019/5-26-2019/20190520081954.txt", encoding = "utf-16le"))

gull <- gull[!(str_detect(gull, "^-"))]
gull <- gull[!(str_detect(gull, "^SS"))]   # rewrite of gull[-(grep("^SS", gull))]

## clean duplicate rows

date <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[1], "\\d{6}"))
time <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[1], "(?<=\\d{6})\\d{4}"))
lat <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[1], "\\d{7}N"))
lon <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[1], "\\d{7}W"))
speed <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[1], "\\d*\\.\\d*"))

t <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[2], "(?<=t=)\\d*"))
U <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[2], "(?<=U=)\\d*\\.\\d*"))
T <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[2], "(?<=T=)\\d*\\.\\d*"))
ID <- sapply(split(gull, ceiling(seq_along(gull)/2)), function(x) str_extract(x[2], "ADI\\d*"))

logger <- as.data.frame(cbind(ID, date, time, lat, long, speed, t, U, T)) %>%
  mutate(lat = paste0(str_extract(lat, "[0-9]{2}"), ".", str_extract(lat, "(?<=[0-9]{2})\\d*")),
         lon = paste0(ifelse(str_detect(lon, "W"), "-", ""),
                      str_extract(lon, "[0-9]{2}"),
                      ".",
                      str_extract(lon, "(?<=[0-9]{2})\\d*")))

```
