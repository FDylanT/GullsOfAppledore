axis.text.y = element_blank(),
axis.ticks.y = element_blank())
states_may2020 <- left_join(us_states, may2020)
ggplot(data = states_may2020, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "white", limits = c(1, 40)) +
labs(fill = "# Resources", title = "May 2020") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
states_aug2020 <- left_join(us_states, aug2020)
ggplot(data = states_aug2020, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "white", limits = c(1, 40)) +
labs(fill = "# Resources", title = "August 2020") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
states_dec2020 <- left_join(us_states, dec2020)
ggplot(data = states_dec2020, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "white", limits = c(1, 40)) +
labs(fill = "# Resources", title = "December 2020") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
setwd("~/Repos/GullsOfAppledore")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
aggData <- read.csv("./data/aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score)) %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")))
count(aggData, birdID)
# Only one datapoint for 0EE, 8EX, 2EE, *UB, 1C3 & 3P2
# Create filtered dataset excluding individuals with only one obs
aggData_filt <- aggData %>%
filter(birdID != "0EE" & birdID != "8EX" & birdID != "2EE" & birdID != "*UB" & birdID != "1C3" & birdID != "3P2")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across all individuals
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData_filt)
summary(m2) # p-value = 3.899e-12
## Check residuals
par(mfrow = c(2, 2))
plot(m2) # strong pattern in residuals --> model needs to change
par(mfrow = c(1, 1))
View(aggData_filt)
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 7) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 7) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
title(main = "Aggression Scores Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
title(main = "Aggression Scores Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
labs(title = "Aggression Scores Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
labs(title = "Aggression Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
count(aggData, birdID) # only one datapoint for 0EE, 8EX, 2EE, *UB, 1C3 & 3P2
# Create filtered dataset including only individuals with 3+ obs
aggData_3 <- aggData %>%
filter(count(birdID) >= 3)
count <- count(aggData, birdID)
count[, 2]
count[, 2] >= 3
count(aggData, birdID)[, 2] >= 3
# Create filtered dataset including only individuals with 3+ obs
aggData_3 <- aggData %>%
filter(count(birdID)[, 2] >= 3)
View(aggData)
# Create filtered dataset including only individuals with 3+ obs
aggData_3 <- aggData %>%
filter(birdID == "4F7" | birdID == "0T4" | birdID == "9EF" | birdID == "2E2" | birdID == "2HZ" | birdID == "1Z5" | birdID == "0HX" | birdID == "7JM" | birdID == "3AP" | birdID == "7U9" | birdID == "7E6" | birdID == "3HE" | birdID == "2M8" | birdID == "9JP" | birdID == "4AC")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Only individuals with 3+ obs
ggplot(aggData_3, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_3, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 7) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_3, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 5) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across individuals with 3+ obs
aggData_3_grp <- aggData_3 %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_3_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
labs(title = "Aggression Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
m2 <- lm(score ~ days_pre_hatch, data = aggData_3)
m2 <- lm(score ~ days_pre_hatch, data = aggData_3)
summary(m2)
m3 <- lm(score ~ days_pre_hatch + birdID, data = aggData_3)
summary(m3)
m4 <- lm(score ~ days_pre_hatch * birdID, data = aggData_3)
summary(m4)
m2 <- lm(score ~ days_pre_hatch, data = aggData_3)
summary(m2)
m3 <- lm(score ~ days_pre_hatch + birdID, data = aggData_3)
summary(m3)
par(mfrow = c(2, 2))
plot(m4)
summary(m4) # include interactions
library(lme4)
install.packages(lme4)
install.packages("lme4")
library(lme4)
lmer(score ~ days_pre_hatch + (1|BirdID))
lmer(score ~ days_pre_hatch + (1|BirdID), data = aggData_3)
lmer(score ~ days_pre_hatch + (1|birdID), data = aggData_3)
m5 <- lmer(score ~ days_pre_hatch + (1|birdID), data = aggData_3)
summary(m5)
anova(m5)
aov(m5)
install.packages("lmerTest")
library(lmerTest)
m6 <- lmer(score ~ days_pre_hatch + (1|birdID), data = aggData_3)
summary(m6)
anova(m6)
## all individuals
n1 <- lm(score ~ days_pre_hatch + nestID, data = aggData)
summary(n1)
n2 <- lm(score ~ days_pre_hatch * nestID, data = aggData)
summary(n2)
## individuals with 3+ obs
n3 <- lm(score ~ days_pre_hatch + nestID, data = aggData_3)
summary(n3)
n4 <- lm(score ~ days_pre_hatch * nestID, data = aggData_3)
summary(n4)
## individuals with 2+ obs
n3 <- lm(score ~ days_pre_hatch + nestID, data = aggData_filt)
summary(n3)
## all individuals
n1 <- lm(score ~ nestID, data = aggData)
summary(n1)
## individuals with 2+ obs
n2 <- lm(score ~ nestID, data = aggData_filt)
summary(n2)
## individuals with 3+ obs
n3 <- lm(score ~ nestID, data = aggData_3)
summary(n3)
## all individuals
n1 <- lm(score ~ nestID, data = aggData)
summary(n1)
?aov()
aov(score ~ nestID, data = aggData)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lme4)
library(lmerTest)
# Chunk 2
setwd("~/Repos/GullsOfAppledore")
aggData <- read.csv("./data/aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score)) %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")))
# count(aggData, birdID) # only one datapoint for 0EE, 8EX, 2EE, *UB, 1C3 & 3P2
# Create filtered dataset excluding individuals with only one obs
aggData_filt <- aggData %>%
filter(birdID != "0EE" & birdID != "8EX" & birdID != "2EE" & birdID != "*UB" & birdID != "1C3" & birdID != "3P2")
count(aggData, birdID) # 3+ obs for 4F7, 0T4, 9EF, 2E2, 2HZ, 1Z5, 0HX, 7JM, 3AP, 7U9, 7E6, 3HE, 2M8, 9JP, 4AC
# Create filtered dataset including only individuals with 3+ obs
aggData_3 <- aggData %>%
filter(birdID == "4F7" | birdID == "0T4" | birdID == "9EF" | birdID == "2E2" | birdID == "2HZ" | birdID == "1Z5" | birdID == "0HX" | birdID == "7JM" | birdID == "3AP" | birdID == "7U9" | birdID == "7E6" | birdID == "3HE" | birdID == "2M8" | birdID == "9JP" | birdID == "4AC")
# Chunk 3
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 7) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across all individuals
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
labs(title = "Aggression Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Chunk 4
ggplot(aggData_3, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_3, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID, ncol = 5) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across individuals with 3+ obs
aggData_3_grp <- aggData_3 %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_3_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
labs(title = "Aggression Over Time, Averaged Across Individuals") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
## all individuals
n1 <- lm(score ~ nestID, data = aggData)
summary(n1)
n2 <- aov(score ~ nestID, data = aggData)
anova(n2)
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ nestID, ncol = 7) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ nestID, ncol = 6) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
## all individuals
n1 <- aov(score ~ nestID, data = aggData)
anova(n1)
ggplot(aggData, aes(x = nestID, y = score, color = nestID)) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData, aes(x = nestID, y = score, color = nestID)) +
geom_point() +
ylim(1, 8) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData, aes(x = nestID, y = score, color = nestID)) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.title = element_blank())
ggplot(aggData, aes(x = nestID, y = score, color = nestID)) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.position = "none")
ggplot(aggData, aes(x = nestID, y = mean(score))) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
# Average scores by nest ID
aggData_nest_grp <- aggData %>%
group_by(nestID) %>%
summarise(score = mean(score))
ggplot(aggData_nest_grp, aes(x = nestID, y = mean(score))) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
ggplot(aggData_nest_grp, aes(x = nestID, y = score)) +
geom_point() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
View(aggData)
