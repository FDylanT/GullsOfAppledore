axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
states_aug2020 <- left_join(us_states, aug2020)
ggplot(data = states_aug2020, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "white", limits = c(1, 40)) +
labs(fill = "# Resources", title = "August 2020") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
states_dec2020 <- left_join(us_states, dec2020)
ggplot(data = states_dec2020, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "white", limits = c(1, 40)) +
labs(fill = "# Resources", title = "December 2020") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
read.csv("Agg_Data.csv")
aggData <- read.csv("Agg_Data.csv")
View(aggData)
aggData <- read.csv("aggData.csv")
View(aggData)
aggData <- read.csv("aggData.csv")
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_line()
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_line()
ggplot(aggData, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point()
table(aggData)
count(aggData, birdID)
aggData_filt <- aggData %>%
filter(count(birdID) != 1)
aggData_filt <- aggData %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, group = birdID, color = birdID)) +
geom_line() +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, group = birdID, color = birdID)) +
geom_point() +
geom_line() +
scale_x_reverse()
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
facet_wrap(facets = birdID) +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
facet_wrap(~ birdID) +
scale_x_reverse()
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(days_pre_hatch)
View(aggData_grp)
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(days_pre_hatch, score)
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(days_pre_hatch, mean(score))
warnings()
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(mean(score))
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score)
aggData <- read.csv("aggData.csv") %>%
replace(score == "X", 8)
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score == "X", 8))
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score == "X", 8, NA))
aggData <- read.csv("aggData.csv") #%>%
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8))
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score)
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(mean(score))
warnings()
str(aggData)
aggData <- read.csv("aggData.csv") %>%
mutate(score = as.numeric(score)) %>%
mutate(score = replace(score, score == "X", 8))
aggData <- read.csv("aggData.csv") #%>%
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score))
count(aggData, birdID) # only one datapoint for *UB, 0EE, 1C3, 2EE, 3P2 & 8EX
aggData_filt <- aggData %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
facet_wrap(~ birdID) +
scale_x_reverse()
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
facet_wrap(~ birdID) +
scale_x_reverse() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
scale_x_reverse() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
scale_x_reverse() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(0, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score))
count(aggData, birdID)
# Only one datapoint for *UB, 0EE, 1C3, 2EE, 3P2 & 8EX
# Chunk 3
# Remove individuals with only one obs
aggData_filt <- aggData %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across all individuals
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Consider removing extreme individuals?
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
aggData_filt <- aggData %>%
mutate(birdID = factor(birdID, levels = "0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")) %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
aggData_filt <- aggData %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC"))) %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
scale_color_manual(values = "pal3") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
scale_color_manual(values = pal3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
count(aggData, days_pre_hatch)
aggData$fatherRank <- rank(aggData$days_pre_hatch)
aggData$scoreRank <- rank(aggData$score)
plot(aggData$daysRank, aggData$scoreRank)
length(aggData$daysRank)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score))
count(aggData, birdID)
count(aggData, days_pre_hatch)
# Only one datapoint for *UB, 0EE, 1C3, 2EE, 3P2 & 8EX
# Chunk 3
# Remove individuals with only one obs
aggData_filt <- aggData %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC"))) %>%
filter(birdID != "*UB" & birdID != "0EE" & birdID != "1C3" & birdID != "2EE" & birdID != "3P2" & birdID != "8EX")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
scale_color_manual(values = pal3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across all individuals
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Consider removing extreme individuals?
aggData$daysRank <- rank(aggData$days_pre_hatch)
aggData$scoreRank <- rank(aggData$score)
plot(aggData$daysRank, aggData$scoreRank)
hist(aggData$score)
View(aggData_grp)
lm1 <- lm(score ~ days_pre_hatch, data = aggData)
summary(lm1)
lm1_plot <- ggplot(aggData, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(aggData, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_smooth(method = "lm")
plot(lm1_plot, which = 1)
plot(lm1, which = 1)
plot(m1, which = 2)
## Check residuals
plot(m1)
m1 <- lm(score ~ days_pre_hatch, data = aggData)
summary(m1) # p-value = 0.7708
ggplot(aggData, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_smooth(method = "lm")
## Check residuals
plot(m1)
par(mfrow = c(2, 2))
plot(m1)
boxplot(score ~ birdID, data = aggData)
par(mfrow = c(1, 1))
boxplot(score ~ birdID, data = aggData)
boxplot(score ~ birdID, data = aggData_filt)
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData)
summary(m2) # p-value =
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
par(mfrow = c(1, 1))
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score)) %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")))
count(aggData, birdID)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score)) %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")))
count(aggData, birdID) # only one datapoint for 0EE, 8EX, 2EE, *UB, 1C3, 3P2
# Create filtered dataset excluding individuals with only one obs
aggData_filt <- aggData %>%
filter(birdID != "0EE" & birdID != "8EX" & birdID != "2EE" & birdID != "*UB" & birdID != "1C3" & birdID != "3P2")
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
scale_color_manual(values = pal3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData_filt)
summary(m2) # p-value = 4.138e-12
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
par(mfrow = c(1, 1))
m2 <- lm(score ~ days_pre_hatch * birdID, data = aggData_filt) # use filtered dataset
summary(m2) # p-value =
str(aggData_filt)
aggData_filt <- aggData_filt %>%
mutate(days_pre_hatch = as.factor(days_pre_hatch))
m2 <- lm(score ~ days_pre_hatch * birdID, data = aggData_filt) # use filtered dataset
summary(m2)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
aggData <- read.csv("aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score)) %>%
mutate(birdID = factor(birdID, levels = c("0EE", "9Z4", "8EX", "4F7", "2EE", "6V4", "0T4", "6HU", "1K9", "9EF", "2E2", "*UB", "0HZ", "2HZ", "1Z5", "5Y3", "0HX", "7JM", "3AP", "9AC", "1HY", "1C3", "7U9", "0AC", "7E6", "3HE", "2M8", "0FU", "3P2", "FED", "1M7", "9JP", "6R3", "4AC")))
count(aggData, birdID) # only one datapoint for 0EE, 8EX, 2EE, *UB, 1C3, 3P2
# Create filtered dataset excluding individuals with only one obs
aggData_filt <- aggData %>%
filter(birdID != "0EE" & birdID != "8EX" & birdID != "2EE" & birdID != "*UB" & birdID != "1C3" & birdID != "3P2")
# Chunk 3
ggplot(aggData_filt, aes(x = days_pre_hatch, y = score, color = nestID)) +
geom_point() +
geom_line() +
facet_wrap(~ birdID) +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Average scores per incubation day across all individuals
aggData_grp <- aggData %>%
group_by(days_pre_hatch) %>%
summarise(score = mean(score))
ggplot(aggData_grp, aes(x = days_pre_hatch, y = score)) +
geom_point() +
geom_line() +
scale_x_reverse() +
ylim(1, 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# 1: Does aggression throughout the breeding season vary among individuals?
str(aggData_filt)
m2 <- lm(score ~ days_pre_hatch * birdID, data = aggData_filt) # use filtered dataset
summary(m2) # p-value = 3.83e-8
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
par(mfrow = c(1, 1))
# 2: Does an individual's aggression vary over the course of the breeding season? (i.e. Is each individual gull's aggression affected by incubation timepoint?) #USE FILT DATA
# Test for linear relationship
aggData$daysRank <- rank(aggData$days_pre_hatch)
aggData$scoreRank <- rank(aggData$score)
plot(aggData$daysRank, aggData$scoreRank)
m2 <- lm(score ~ days_pre_hatch * birdID, data = aggData_filt) # use filtered dataset
summary(m2) # p-value = 3.83e-8
plot(m2, which = 1)
plot(m2)
m2 <- lm(score ~ days_pre_hatch * birdID, data = aggData_filt) # use filtered dataset
summary(m2) # p-value = 3.83e-8
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData_filt) # use filtered dataset
summary(m2) # p-value = 3.83e-8
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
setwd("~/Repos/GullsOfAppledore")
aggData <- read.csv("./data/aggData.csv") %>%
mutate(score = replace(score, score == "X", 8)) %>%
mutate(score = as.numeric(score))
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData)
summary(m2)
## Check residuals
par(mfrow = c(2, 2))
plot(m2)
par(mfrow = c(1, 1))
m2 <- lm(score ~ days_pre_hatch + birdID, data = aggData_filt)
summary(m2)
